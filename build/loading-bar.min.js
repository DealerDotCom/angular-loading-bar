/*! 
 * angular-loading-bar v0.9.0
 * https://chieffancypants.github.io/angular-loading-bar
 * Copyright (c) 2016 Wes Cruver
 * License: MIT
 */
!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(a){var b=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(b,c,d,e,f,g){function h(){d.cancel(j),g.complete(),l=0,k=0}function i(b){var d,e=c.get("$http"),f=a.defaults;!b.cache&&!f.cache||b.cache===!1||"GET"!==b.method&&"JSONP"!==b.method||(d=angular.isObject(b.cache)?b.cache:angular.isObject(f.cache)?f.cache:e);var g=void 0!==d&&void 0!==d.get(b.url);return void 0!==b.cached&&g!==b.cached?b.cached:(b.cached=g,g)}var j,k=0,l=0,m=g.latencyThreshold;return{request:function(a){return a.ignoreLoadingBar||i(a)||(e.$broadcast("cfpLoadingBar:loading",{url:a.url}),0===k&&(j=d(function(){g.start()},m)),k++,g.set(l/k)),a},response:function(a){return a&&a.config?(a.config.ignoreLoadingBar||i(a.config)||(l++,l>=k?(e.$broadcast("cfpLoadingBar:loaded",{url:a.config.url,result:a}),h()):g.set(l/k)),a):(f.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),a)},responseError:function(a){return a&&a.config?(a.config.ignoreLoadingBar||i(a.config)||(l++,l>=k?(e.$broadcast("cfpLoadingBar:loaded",{url:a.config.url,result:a}),h()):g.set(l/k)),b.reject(a)):(f.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),b.reject(a))}}}];a.interceptors.push(b)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){function a(a,b,c){var d,e=this,f=angular.element(c.loadingBarTemplate),g=f.find("div").eq(0),h=angular.element(c.spinnerTemplate),i=0,j=function(){var b=a[0],d=b.querySelector?b.querySelector(c.parentSelector):a.find(c.parentSelector)[0];d||(d=b.getElementsByTagName("body")[0]);var e=angular.element(d);c.includeBar&&(e.append(f),f.addClass("in")),c.includeSpinner&&(e.append(h),h.addClass("in"))};j(),this.activate=function(){e.set(c.startSize)},this.status=function(){return i},this.set=function(a){var f=100*a+"%";g.css("width",f),i=a,c.autoIncrement&&(b.cancel(d),d=b(function(){e.inc()},250))},this.inc=function(){if(!(e.status()>=1)){var a=0,b=e.status();a=b>=0&&b<.25?(3*Math.random()+3)/100:b>=.25&&b<.65?3*Math.random()/100:b>=.65&&b<.9?2*Math.random()/100:b>=.9&&b<.99?.005:0;var c=e.status()+a;e.set(c)}},this.cleanup=function(){h.addClass("out"),f.addClass("out"),b(function(){h.remove(),f.remove()},c.fadeOutDuration)}}this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.fadeOutDuration=350,this.$get=["$injector","$document","$timeout","$rootScope",function(b,c,d,e){function f(){d.cancel(k),n||(n=new a(c,d,m),n.activate(),e.$broadcast("cfpLoadingBar:started"))}function g(a){n&&n.set(a)}function h(){n&&n.inc()}function i(){return n?n.status():0}function j(){g(1),d.cancel(k),k=d(function(){n.cleanup(),n=null,e.$broadcast("cfpLoadingBar:completed")},500)}var k,l=this,m={parentSelector:l.parentSelector,loadingBarTemplate:l.loadingBarTemplate,spinnerTemplate:l.spinnerTemplate,autoIncrement:l.autoIncrement,includeSpinner:l.includeSpinner,includeBar:l.includeBar,startSize:l.startSize,fadeOutDuration:l.fadeOutDuration},n=null;return{start:f,set:g,status:i,inc:h,complete:j,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}();